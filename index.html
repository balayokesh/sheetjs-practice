<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Javascript test</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0-beta1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-0evHe/X+R7YkIZDRvuzKMRqM+OrBnVFBL6DOitfPri4tjfHxaWutUpFmBp4vmVor" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0-beta1/dist/js/bootstrap.bundle.min.js" integrity="sha384-pprn3073KE6tl6bjs2QrFaJGz5/SUsLqktiwsUTF55Jfv3qYSDhgCecCxMW52nD2" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script>
        let data = [
            'No records'
        ]
        function handleDownload() {
            alert('Clicked');
            var workbook = XLSX.utils.book_new();
            var worksheet = XLSX.utils.aoa_to_sheet(data);
            workbook.SheetNames.push("First");
            workbook.Sheets["First"] = worksheet;

            // TO BINARY STRING
            var xlsbin = XLSX.write(workbook, {
                bookType: "xlsm",
                type: "binary"
            });

            // TO BLOB OBJECT
            var buffer = new ArrayBuffer(xlsbin.length),
                array = new Uint8Array(buffer);
            for (var i = 0; i < xlsbin.length; i++) {
                array[i] = xlsbin.charCodeAt(i) & 0XFF;
            }
            var xlsblob = new Blob([buffer], { type: "application/octet-stream" });
            delete array;
            delete buffer;
            delete xlsbin;

            // Trigger download window
            var url = window.URL.createObjectURL(xlsblob);
            var anchor = document.createElement("a");
            anchor.href = url;
            anchor.download = "demo.xlsm";
            anchor.click();
            window.URL.revokeObjectURL(url);
            delete anchor;
        }

        function handleSubmit() {
            event.preventDefault();
            let mark1 = document.getElementById('mark1').value;
            let mark2 = document.getElementById('mark2').value;
            let mark3 = document.getElementById('mark3').value;
            let mark4 = document.getElementById('mark4').value;
            let mark5 = document.getElementById('mark5').value;
            let mark6 = document.getElementById('mark6').value;
            
            console.log(mark1);
            console.log(mark2);
            console.log(mark3);
            console.log(mark4);
            console.log(mark5);
            console.log(mark6);

            document.getElementById('output1').innerHTML = "Target Year: " + mark1;
            document.getElementById('output2').innerHTML = "Region: " + mark2;
            document.getElementById('output3').innerHTML = "Country Selector: " + mark3;
            document.getElementById('output4').innerHTML = "Mode Selection: " + mark4;
            document.getElementById('output5').innerHTML = "Fleet Selector: " + mark5;
            document.getElementById('output6').innerHTML = "Vehicle Segment: " + mark6;
        }
    </script>
</head>

<body class="text-center">
    <h1 class="h1 bg-dark p-3 text-white">Javascript test</h1>

    <h3 class="text-left">
        Data
        <button class="btn btn-danger d-inline" onclick=handleDownload()> â†“ Download Excel</button>
    </h3>
    <div class="border rounded p-3 bg-success m-3 w-50 d-inline-block">
        <p id='output1' class="h4">Target Year: -</p>
        <hr />
        <p id='output2' class="h4">Region: -</p>
        <hr />
        <p id='output3' class="h4">Country Selector: -</p>
        <hr />
        <p id="output4" class="h4">Mode Selection: -</p>
        <hr />
        <p id="output5" class="h4">Fleet Selector: -</p>
        <hr />
        <p id="output6" class="h4">Vehicle Segment: -</p>
    </div>

    <h3>Data update form</h3>
    <form class="border rounded p-3 bg-primary text-white m-3 w-50 d-inline-block">
        <br />
        <label for='mark1'>Target Year:</label>
        <input type='number' id='mark1' class="form-control w-50 d-inline m-1" placeholder="2050" />
        <br />
        <label for='mark2'>Region:</label>
        <input type='text' id='mark2' class="form-control w-50 d-inline m-1" placeholder="MENA" />
        <br />
        <label for='mark3'>Country Selector:</label>
        <input type='text' id='mark3' class="form-control w-50 d-inline m-1" placeholder="Yemen" />
        <br />
        <label for='mark4'>Mode Selection:</label>
        <input type='test' id='mark4' class="form-control w-50 d-inline m-1" placeholder="Segment" />
        <br />
        <label for='mark5'>Fleet Selector:</label>
        <input type='text' id='mark5' class="form-control w-50 d-inline m-1" placeholder="New vehicle" />
        <br />
        <label for='mark6'>Vehicle Segment:</label>
        <input type='number' id='mark6' class="form-control w-50 d-inline m-1" placeholder="5" />
        <br />
        <button onclick=handleSubmit() class="btn btn-warning m-3">Update data</button>
    </form>
</body>
</html>