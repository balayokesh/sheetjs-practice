<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Javascript test</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0-beta1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-0evHe/X+R7YkIZDRvuzKMRqM+OrBnVFBL6DOitfPri4tjfHxaWutUpFmBp4vmVor" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0-beta1/dist/js/bootstrap.bundle.min.js" integrity="sha384-pprn3073KE6tl6bjs2QrFaJGz5/SUsLqktiwsUTF55Jfv3qYSDhgCecCxMW52nD2" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script>
        let data = [
            'No records'
        ]
        function handleDownload() {
            alert('Clicked');
            var workbook = XLSX.utils.book_new();
            var worksheet = XLSX.utils.aoa_to_sheet(data);
            workbook.SheetNames.push("First");
            workbook.Sheets["First"] = worksheet;

            // TO BINARY STRING
            var xlsbin = XLSX.write(workbook, {
                bookType: "xlsm",
                type: "binary"
            });

            // TO BLOB OBJECT
            var buffer = new ArrayBuffer(xlsbin.length),
                array = new Uint8Array(buffer);
            for (var i = 0; i < xlsbin.length; i++) {
                array[i] = xlsbin.charCodeAt(i) & 0XFF;
            }
            var xlsblob = new Blob([buffer], { type: "application/octet-stream" });
            delete array;
            delete buffer;
            delete xlsbin;

            // Trigger download window
            var url = window.URL.createObjectURL(xlsblob);
            var anchor = document.createElement("a");
            anchor.href = url;
            anchor.download = "demo.xlsm";
            anchor.click();
            window.URL.revokeObjectURL(url);
            delete anchor;
        }

        function handleSubmit() {
            event.preventDefault();
            let mark1 = document.getElementById('mark1').value;
            let mark2 = document.getElementById('mark2').value;
            let mark3 = document.getElementById('mark3').value;
            data = [
                ["Mark1", mark1],
                ["Mark2", mark2],
                ["Mark3", mark3]
            ];
            console.log(data);
            document.getElementById('output1').innerHTML = "Mark1: " + mark1;
            document.getElementById('output2').innerHTML = "Mark2: " + mark2;
            document.getElementById('output3').innerHTML = "Mark3: " + mark3;
        }
    </script>
</head>

<body class="text-center">
    <h1 class="h1 bg-dark p-3 text-white">Javascript test</h1>

    <h3 class="text-left">
        Data
        <button class="btn btn-danger d-inline" onclick=handleDownload()> â†“ Download Excel</button>
    </h3>
    <div class="border rounded p-3 bg-success m-3 w-50 d-inline-block">
        <p id='output1' class="h4">Mark1: 0</p>
        <hr />
        <p id='output2' class="h4">Mark2: 0</p>
        <hr />
        <p id='output3' class="h4">Mark3: 0</p>
    </div>

    <h3>Data update form</h3>
    <form class="border rounded p-3 bg-primary text-white m-3 w-50 d-inline-block">
        <label for='mark1'>Mark1:</label>
        <input type='number' id='mark1' class="form-control w-50 d-inline m-1" />
        <br />
        <label for='mark2'>Mark2:</label>
        <input type='number' id='mark2' class="form-control w-50 d-inline m-1" />
        <br />
        <label for='mark3'>Mark3:</label>
        <input type='number' id='mark3' class="form-control w-50 d-inline m-1" />
        <br />
        <button onclick=handleSubmit() class="btn btn-warning">Update data</button>
    </form>
</body>
</html>